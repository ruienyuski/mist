import{i as x,o as k,m as C,e as w,b as i,c as r,u as c,f as t,F as S,n as I,a as F,g as v,w as u,v as N,t as d,h as f,d as D}from"./index-a98e8c24.js";import{u as O}from"./Products-95c02508.js";import{u as $}from"./Fav-13b51e6e.js";import{u as j}from"./Cart-e9906d83.js";const P={class:"container container_mb"},V={key:0,class:"col text-center"},B=t("div",{class:"p-3 text-center cart_title"},"尚未加入最愛",-1),J=[B],T={key:1,class:"row row-cols-1 justify-content-between"},A={class:"col cart_width"},E={class:"text-end my-1"},M=t("i",{class:"far fa-trash-alt"}," 刪除所有最愛",-1),q=[M],L={class:"row row-cols-1 row-cols-md-4 g-2"},U={class:"card"},z=["onClick"],G={class:"material-icons md-32 text-danger"},H=["src"],K={class:"card-body"},Q={class:"col-12 align-self-center cart_product_item"},R={class:"product_title"},W={class:"card-footer card_footer_bg d-flex py-3 px-0 justify-content-between"},X=["onClick"],Y={key:0,class:"fas fa-spinner fa-spin"},Z={class:"col"},nt={__name:"Fav",setup(tt){const l=O(),o=$(),_=j(),m=x("emitter");k(()=>{l.getData()});const p=a=>{let s=o.favorited.findIndex(n=>a===n);o.favorited.splice(s,1),localStorage.setItem("favorite",JSON.stringify(o.favorited))},h=()=>{o.favorited=[],localStorage.setItem("favorite",JSON.stringify(o.favorited))},g=()=>{const a="/apipath/cart";o.favorited.forEach(s=>{const n={product_id:s,qty:1};F.post(a,{data:n}).then(()=>{let e=o.favorited.indexOf(s);o.favorited.splice(e,1),localStorage.setItem("favorite",JSON.stringify(o.favorited)),_.loadingItem="",l.getData(),m.emit("cart_num")})})},b=C(()=>l.products.filter(a=>o.favorited.indexOf(a.id)>-1));return(a,s)=>{const n=w("router-link");return i(),r("div",P,[c(o).favorited.length===0?(i(),r("div",V,J)):(i(),r("div",T,[t("div",A,[t("div",E,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm mx-1 my-1",onClick:s[0]||(s[0]=e=>h())},q),t("button",{type:"button",class:"btn btn-outline-success btn-sm mx-1 my-1",onClick:s[1]||(s[1]=e=>g())}," 全部加入購物車 ")]),t("div",L,[(i(!0),r(S,null,I(b.value,e=>(i(),r("div",{class:"col",key:e.id},[t("div",U,[v(n,{class:"relative",to:{name:"ProductDetail",params:{id:e.id}}},{default:u(()=>[t("span",{class:"product_like",onClick:N(y=>p(e.id),["prevent"])},[t("i",G,d(c(o).favState(e.id)),1)],8,z),t("img",{class:"object-fit-cover card-img-top",height:"250",src:e.imageUrl},null,8,H)]),_:2},1032,["to"]),t("div",K,[t("div",Q,[t("div",R,d(e.title),1),t("div",null,"NT$ "+d(e.price)+" / "+d(e.unit),1)])]),t("button",W,[t("div",{class:"col border-end border-secondary",onClick:y=>c(_).addToCart(e)},[f(" 加入購物車 "),c(_).loadingItem==e.id?(i(),r("i",Y)):D("",!0)],8,X),t("div",Z,[v(n,{to:{name:"ProductDetail",params:{id:e.id}}},{default:u(()=>[f(" 查看更多 ")]),_:2},1032,["to"])])])])]))),128))])])]))])}}};export{nt as default};
