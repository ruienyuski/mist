import{s as w,B as C,i as L,r as _,o as B,a as y,e as N,C as V,b as o,c as l,f as t,g as $,w as j,v as D,F as O,n as E,h,t as e,x as F,d as I}from"./index-fd10dcc9.js";const M={class:"container container_mb"},R={key:0},S={class:"alert alert-warning",role:"alert"},q=t("h2",{class:"text-center"},"找不到訂單",-1),z={class:"text-center my-2"},P={class:"row justify-content-center"},T={class:"check_order_width col-md-8"},A=t("div",{class:"p-3 text-center check_list_title"},"訂單內容",-1),G={class:"my-3 p-3"},H={class:"table text-dark align-middle"},J=t("thead",null,[t("tr",null,[t("th",null,"品名"),t("th",null,"數量"),t("th",{class:"text-end"},"單價")])],-1),K={class:"text-end"},Q={key:0,class:"check_order_total"},U={class:"text-danger fs-6 lh-lg"},W=t("td",{class:"text-end"},"總計",-1),X={class:"text-end"},Y={key:1,class:"check_order_total"},Z=t("td",{colspan:"2",class:"text-end"},"總計",-1),tt={class:"text-end"},et={class:"check_order_width col-md-8"},st=t("div",{class:"p-3 text-center check_list_title"},"付款內容",-1),ot={class:"my-3 p-3"},lt={class:"table text-dark"},ct=t("th",null,"Email",-1),nt=t("th",null,"姓名",-1),at=t("th",null,"收件人電話",-1),dt=t("th",null,"收件人地址",-1),it=t("th",null,"訂單編號 ",-1),rt={class:"text-danger lh-1"},_t={type:"button",class:"btn btn-info"},ut=t("p",{class:"text-secondary lh-1 fs-6"}," (若要查詢訂單付款狀況，請複製訂單編號)",-1),ht=t("th",null,"付款狀態",-1),pt={key:0,class:"text-danger"},vt={key:1,class:"text-success fw-bold fs-6"},mt={key:0,class:"text-center col"},xt=t("button",{class:"btn btn-danger mb-3"},"確認付款去",-1),yt=[xt],kt={__name:"Payment",setup(bt){const b=w(),f=C(),a=L("emitter"),s=_({user:{},products:[],total:0,message:"",is_paid:!1,id:""}),p=_(!1),v=_(""),m=_(0),d=_("");B(()=>{d.value=f.params.orderId,x()});const x=()=>{a.emit("isLoading",!0);const u=`https://ec-course-api.hexschool.io/v2/api/207a7721/order/${d.value}`;y.get(u).then(i=>{var r,n;const c=Object.values((n=(r=i==null?void 0:i.data)==null?void 0:r.order)==null?void 0:n.products)[0].coupon;c?(p.value=!0,v.value=c==null?void 0:c.title,m.value=c==null?void 0:c.percent):(p.value=!1,v.value="",m.value=0),s.value=i.data.order,a.emit("isLoading",!1)})},k=()=>{const u=`https://ec-course-api.hexschool.io/v2/api/207a7721/pay/${d.value}`;a.emit("isLoading",!0),y.post(u).then(()=>{x(),b.push("/checksuccess"),a.emit("isLoading",!1)}).catch(()=>{a.emit("webmessage","付款確認失敗","danger")})},g=()=>{a.emit("webmessage","已複製完成","success")};return(u,i)=>{const c=N("router-link"),r=V("clipboard");return o(),l("div",M,[s.value?(o(),l("form",{key:1,onSubmit:D(k,["prevent"])},[t("div",P,[t("div",T,[A,t("div",G,[t("table",H,[J,t("tbody",null,[(o(!0),l(O,null,E(s.value.products,n=>(o(),l("tr",{key:n.id},[t("td",null,e(n.product.title),1),t("td",null,e(n.qty)+"/"+e(n.product.unit),1),t("td",K,e(n.product.price),1)]))),128))]),t("tfoot",null,[p.value?(o(),l("tr",Q,[t("td",U,[h(" 優惠卷名稱: "+e(v.value)+" ",1),t("p",null,"折扣："+e(m.value)+" %",1)]),W,t("td",X,e(s.value.total)+" 元",1)])):(o(),l("tr",Y,[Z,t("td",tt,e(s.value.total)+" 元",1)]))])])])]),t("div",et,[st,t("div",ot,[t("table",lt,[t("tbody",null,[t("tr",null,[ct,t("td",null,e(s.value.user.email),1)]),t("tr",null,[nt,t("td",null,e(s.value.user.name),1)]),t("tr",null,[at,t("td",null,e(s.value.user.tel),1)]),t("tr",null,[dt,t("td",null,e(s.value.user.address),1)]),t("tr",null,[it,t("td",null,[t("p",rt,[h(e(d.value)+" ",1),F((o(),l("button",_t,[h(" 複製 ")])),[[r,d.value,"copy"],[r,g,"success"]])]),ut])]),t("tr",null,[ht,t("td",null,[s.value.is_paid?(o(),l("span",vt,"付款完成")):(o(),l("span",pt,"尚未付款"))])])])])]),s.value.is_paid===!1?(o(),l("div",mt,yt)):I("",!0)])])],32)):(o(),l("div",R,[t("div",S,[q,t("div",z,[$(c,{to:"/checkpayment",style:{"font-size":"1.2rem"}},{default:j(()=>[h("回訂單查詢")]),_:1})])])]))])}}};export{kt as default};
